# Minimal Module Template

Minimalistic module, that can be used as a template for writing modules.


## Directories

Directory name of the module defines __module name__. Therefore this 
module is named `templates_minimal_1`.

Module name consists of __base name__ (`templates_minimal`) and __major
version suffix__ (`_1`). __Base name__ also consists of two parts: __vendor id__
(`templates`) and __module id__ (`minimal`).

Typically each module will have directory structure similar to this one.

- `include` - public header files (available to other modules).
    - __vendor id__ - `templates` should be renamed to match __vendor id__.
        - __module id__ - `minimal` should be renamed to match __module id__.
            - `internal` - some headers need to be publicly available, but are
            implementation detail. This directory is for such files.
- `src` - Private header files and implementation.
    - __vendor id__ - `templates` should be renamed to match __vendor id__.
        - __module id__ - `minimal` should be renamed to match __module id__.
            - `plugin` - plugin-specific files (if module is a plugin).
            - `internal` - corresponds with `internal` subdirectory inside 
            `include` directory.

To keep things in order and avoid naming conflicts C++ namespaces should reflect
above directory structure.


## Files

There are few files you have to edit in order to make custom module based on
this template. Inside these files you can find `Edit!` comments, which denote
that some edition to the line is necessary.

Here is a brief explanation of these files.

- `README.md`

This file should contain brief description of the module and optionally
main page of documentation.


- `LICENSE`

This file should contain license applicable to your module.


- `templates_minimal_1.qbs`

This file defines module in terms of Qbs product. The name of this file should
be the same as directory name of the module, so you have to rename it.

```qbs
import cutehmi
```
This line is required to import `cutehmi` Qbs items.

```qbs
cutehmi.Module {
```
All modules inherit after cutehmi.Module item, which itself inherits after
cutehmi.CommonProduct. You can find definitions of these items in `qbs`
directory.

One of the noticeable things is that cutehmi.Module item depends on
cutehmi.metadata Qbs module, which will generate `cutehmi.metadata.json` and
`cutehmi.metadata.hpp` files. These files will contain the meta-information
extracted from properties of the Qbs file.

```qbs
name: "templates_minimal_1"
```
Product name is the same as __module name__. This is also the same as directory
name of the module.

```qbs
minor: 0

micro: 0
```
Minor version has to be specified as it is not inhered within `name` of
the product. Micro version also has to be specified. They may need to be editted
in future, but it is uncommon to use other values than zeros for initial version
of module.

```qbs
vendor: "The Secret Order of Templates"

friendlyName: "Minimal Module Template"
```
Human-friendly vendor and product names.

```qbs
description: "Minimalistic module, that can be used as a template for writing modules."
```
Description of the product.

```qbs
author: "Sheev Palpatine"
```
Author of the product.

```qbs
copyright: "KGB"
```
Copyright holder.

```qbs
license: "Mozzarella Public License, v. alpha"
```
A license of the product. This should correspond to supplied `LICENSE` file.

```qbs
Depends { name: "cutehmi_1" }
cutehmi_1.reqMinor: 0
```
Tho' it is possible to create module that is independent from all other
modules, it is desirable to "glue" it with the rest of the framework
using `cutehmi_1` module.

Property `cutehmi_1.reqMinor` specifies required, minimal, minor version of
`cutehmi_1` module.


- `include\templates\minimal\metadata.hpp`

This file exposes metadata, autogenerated from `qbs` file, to other
modules.


- `include\templates\minimal\logging.hpp`

This header and corresponding source file enable Qt logging capabilities for the
module. Check
[QLoggingCategory Class](http://doc.qt.io/qt-5/qloggingcategory.html) for more
information.

This file contains namespaces.
```cpp
namespace templates {
namespace minimal {
```
Namespaces reflect the directory structure. Because this file lies inside 
`templates/minimal` subdirectory of the `include` directory it uses
`namespace minimal` nested inside `namespace templates`. Modify namespaces
accordingly.


- `src\templates\minimal\logging.cpp`

This source file and corresponding header enable Qt logging capabilities for the
module. Check
[QLoggingCategory Class](http://doc.qt.io/qt-5/qloggingcategory.html) for more
information.


- `include\templates\minimal\internal\common.hpp`

This file includes common headers and provides common macro definitions used by
nearly all other source files of the module it belongs to.

```cpp
#ifdef TEMPLATES_MINIMAL_DYNAMIC
	#ifdef TEMPLATES_MINIMAL_BUILD
		//export symbols to dll
		#define TEMPLATES_MINIMAL_API Q_DECL_EXPORT
	#else
		//using functions from dll
		#define TEMPLATES_MINIMAL_API Q_DECL_IMPORT
	#endif
#else
	#define TEMPLATES_MINIMAL_API
#endif
```
Above macro definitions wrap standard Qt `Q_DECL_EXPORT` and `Q_DECL_IMPORT`
macros. All classes or functions you want to expose to other modules shall be
decorated with `TEMPLATES_MINIMAL_API` macro (or rather
`YOU_YOURMODULE_API` after you have renamed it). Check out
[Creating Shared Libraries](https://doc.qt.io/Qt-5/sharedlibrary.html) for more
details.


